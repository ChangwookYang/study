##### 4.17 공부 - 서버 인증

## 세션/쿠키, JWT

HTTP는 응답 후 연결을 끊게되며 과거에 대한 정보를 전혀 담고있지 않다.

즉, 지금 보낼 HTTP 요청은 지난 번에 내 정보를 담아보냈던 HTTP 요청과는 전혀 관계없다.

따라서 각각의 HTTP 요청에는 주체가 누구인지에 대한 정보가 필수적이다.

HTTP 메시지 구조는 헤더와 바디 두가지로 구성되며, 공백은 헤더와 바디를 구분짓는다.

1. 인증 방식 첫번째로는 계정 정보를 요청 헤더에 넣는 방식이 있다.

그러나 해커가 마음만 먹으면 HTTP 요청을 가로채서 사용자의 계정 정보를 알 수 있다.

2. Session / Cookie 방식

   * 순서는 아래와 같다.

     * 1. 사용자가 로그인을 한다.

       2. 서버에서는 계정정보를 읽어 사용자를 확인한 후 사용자의 고유한 ID값을 부여하여

          세션 저장소에 저장한 후 이와 연결되는 세션 ID를 발행한다.

       3. 사용자는 서버에서 해당 세션 ID를 받아 쿠키에 저장한 후, 인증이 필요한 요청마다

          쿠키를 헤더에 실어서 보낸다.

       4. 서버에서는 쿠키를 받아 세션 저장소에서 대조한 후 대응되는 정보를 가져온다.

       5. 인증이 완료되고 서버는 사용자에 맞는 데이터를 보내준다.

   * 세션 쿠키 방식의 인증은 기본적으로 세션 저장소를 필요로한다.(주로 Redis 사용)

   * 세션 저장소는 로그인 했을때 사용자의 정보를 저장하고 열쇠가 되는 세션 ID값을 만든다.

   * 그리고 HTTP 헤더에 실어 사용자에게 돌려보낸다.

   * 그러면 사용자는 쿠키로 보관하고 있다가 인증이 필요한 요청에 쿠키를 넣어 보낸다.

   * 웹서버에서는 세션 저장소에서 쿠키(세션ID)를 받고 저장되어 있는 정보와 매칭시켜 인증한다.

